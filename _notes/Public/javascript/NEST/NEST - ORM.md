---
title: NEST - ORM
feed: hide
---

# ORM

## 영속성
- 데이터를 생성한 프로그램을 종료해도 사라지지 않는 데이터의 특성
	- 영속성을 갖지 않으면 메모리에서만 존재한다. 프로그램을 종료하면 모두 없어진다.
- Object Persistence
	- 메모리 상의 데이터 / 객체를 파일 시스템, RDB 혹은 객체 DB를 활용하여 영구적으로 저장할 수 있다.
		- 이를 통해 데이터에 영속성을 부여할 수 있다.
- Persistence Layer
	- 프로그램의 아키텍처에서 데이터에 영속성을 부여하는 계층을 의미한다.
	- Persistence framework를 이용한 개발이 자주 이루어진다.
- Persistence Framework
	- 객체화의 복잡함이나 번거로움 없이 간단한 작업으로 DB와 연동되는 시스템을 만든다.
		- 빠르게 개발에 들어갈 수 있으며, 안정적인 구동을 보장할 수 있다.

## ORM
- 객체와 RDB에서 데이터를 자동으로 매핑해주는 것을 말한다.
- 객체 지향 프로그래밍은 클래스를 사용하고, RDB는 테이블을 사용한다.
	- 객체 모델과 관계형 모델간의 타입 불일치가 존재한다.
		- ORM을 통해 객체 간의 관계를 바탕으로 SQL을 생성하고, 이러한 불일치를 해결할 수 있다.
- DB 데이터 - Object 필드를 매핑한다.
	- 객체를 통해 간접적으로 데이터베이스를 다룰 수 있다.
- Persistent API라고 할 수 있다.

### 장점
- 객체 지향적 코드를 통해 직관적이고, 비즈니스 로직에 집중할 수 있다.
	- SQL 쿼리가 아닌 직관적인 코드로 데이터를 조작할 수 있다.
	- 개발자가 쿼리가 아닌 객체 모델로 프로그래밍에 집중할 수 있도록 한다.
		- 선언문, 할당, 종료 등의 부수적인 코드를 줄일 수 있다.
		- 각종 객체에 대한 코드를 별도로 작성하고, 이를 통해 가독성을 높일 수 있다.
		- SQL의 Sequential한 접근이 아닌 객체 지향적인 접근으로 생산성을 증대한다.
- 재사용 및 유지보수의 편리성이 증가한다.
	- ORM은 독립적으로 작성되어 있고, 해당 객체들을 재사용할 수 있다.
		- 모델에서 가공된 데이터를 컨트롤러에 의해 뷰와 합쳐지는 형태로 디자인 패턴을 견고하게 만드는데 유리하다.
	- 매핑 정보가 명확하며 ERD를 보는 것에 대한 의존도를 낮출 수 있다.
- DBMS에 대한 종속성이 줄어든다.
	- 객체 간의 관계를 바탕으로 SQL을 자동 생성한다.
		- RDBMS의 데이터 구조와 객체지향 모델 사이의 간격을 줄일 수 있다.
	- 대부분의 ORM 솔루션은 DB 종속적이지 않다.
		- 구현 방법 뿐만 아니라 많은 솔루션에서 자료형까지 유효하다.
		- 객체에 집중함으로서, DBMS를 교체하는 큰 작업에서도 리스크와 시간을 줄일 수 있다.

### 단점
- 완벽한 ORM으로만 서비스를 구현할 수 없다.
	- 편리한 사용만큼 신중한 설계를 필요로 한다.
		- 프로젝트의 복잡성이 커지면 난이도 또한 올라갈 수 있다.
	- 잘못 구현된 경우 속도 저하 / 심각한 경우 consistency 문제가 발생할 수 있다.
	- 자주 사용되는 대형 쿼리는 속도를 위해 다른 테크닉을 이요할 수 있다.
- DBMS의 고유 기능을 이용할 수 없다.
	- 특정 DBMS의 고유 기능을 이용하면 이식성이 저하되므로, 단점이라 보기 어렵다.
- Procedure가 많은시스템에서 ORM의 객체 지향적인 장점을 활용하기 어렵다.
	- 이미 Procedure가 많은 시스템에서는 다시 객체로 바꿔야 한다.
		- 이 과정에서 생산성 저하나 리스크가 많이 발생할 수 있다.

## The Object-Relational Impedance Mismatch
- Granularity
	- 경우에 따라 DB에 있는 테이블 수보다 더 많은 클래스를 가진 객체 모델을 가질 수 있다.
		- 여러 개의 클래스에 담긴 데이터를 하나의 테이블에 저장할 수 잇다.

 - Inheritance
	- RDBMS에서는 상속의 개념이 없다.

- Identity
	- RDBMS는 sameness라는 하나의 개념을 정확히 정의한다.
		- Primary Key를 통해 정의한다.
	- RDBMS에서는 Primary Key가 동일하면 서로 동일한 record로 정의한다.
		- 다른 언어에서는 주솟값이 같은 것과 내용이 같은 경우를 구분하여 정의할 수 있다.

- Associations
	- 객체 지향 언어는 객체 참조를 사용하는 연관성을 나타낸다.
	- RDBMS는 연관성을 foreign key로 정의할 수 있다.
	- 프로그래밍 언어에서는 연관성에 방향성이 존재하고, RDBMS에선 이러한 방향성이 존재하지 않는다.

- Navigation
	- OOP와 RDBMS에서 객체에 접근하는 방법은 근본적으로 다르다.
		- 프로그래밍 언어에서는 하나의 연결에서 다른 연결로 이동하며 탐색한다.
			- 그래프 형태로 탐색하고, 이는 RDBMS에서 효율적인 방법이 아니다.
		- RDBMS에서는 SQL 쿼리 수를 최소화하고 JOIN을 통해 여러 엔티티를 로드하고 원하는 대상 엔티티를 선택하도록 한다.

[[출처 : # \[DB\] ORM이란](https://gmlwjd9405.github.io/2019/02/01/orm.html)]
