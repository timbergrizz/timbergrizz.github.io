---
title: Kubeflow - Why Kubeflow?
feed: hide
---
- 출처 [Kurly만의 MLOps 구축하기 - 쿠브플로우 도입기](https://helloworld.kurly.com/blog/second-mlops/)

## MLOps
- MLOps는 머신러닝 다루는 사람이 상용으로 올라가게 되면 필요한 개선사항을 반영하여아 한다.
	- 모델도 바뀌고, 바뀐 모델에 대해 제공도 해야 하는 등의 과정이 존재한다.
	- 적용 자체가 과정이 넓다.
- 사진을 넣으면 사진에 대해 포맷을 바꾸는 등의 과정을 필요로 하는 것이다.
	- 어플리케이션이 api로 받을때, 어플리케이션은 다시 백엔드로 보내 이를 모델에 반영할 수 있어야 한다.
- devops와 mlops는 결국 두개가 합쳐질 수 있고, 분야 별로 다르게 표현되는 부분들도 있다.
- 지금은 쿠버네티스 위에서 각 단계를 파이프라인으로 연결시키는 관점으로 접근하는 것이 된다.
	- 텐서플로우가 모델에 대한 처리를 위한 라이브러리
	- 앞 뒤로 전처리, 분석, 예측하는 과정을 필요로 한다.
	- kubeflow는 각각의 단계를 입/출력을 맞춰놓고 설계할 수 있도록 하는 라이브러리이다.
- Ai에 맞춰 진화된 DevOps
	- DataOps + DevOps + ModelOps
- 노트북을 저장하면, 텐서에서 열어서 시각화되곤 하는데, 서비스로 구성되어 있으면 공유 볼륨으로 구성되어 있을 때 텐서보드 열어서 확인하는 등의 과정을 거칠 수 있다.
	- Kale 엔진이 중요한거다.

## What is Kubeflow
-   KubeFlow는 K8s에 MLOps에 필요한 툴킷들을 추가하는 느낌이다.
    -   여러가지 서비스 컴포넌트들이 있다.
    -   도커랑 MSA 이해하면 많은것이 도움 될 것이다.

- 쿠버네티스 위에서 머신 러닝을 위한 다양한 오픈 소스들을 종합적으로 관리하고 운영하는 플랫폼
- 다음 3가지 원칙에 따라 설계되었다.
	- composability
		- 머신러닝 워크플로우의 컴포넌트들을 프로젝트의 요구 조건(버전, 라이브러리 등)에 따라 구성할 수 있도록 한다.
	- portability
		- 로컬, 온프레미스, 클라우드 등 환경에 관계 없이 다양한 환경에서 배포 가능하도록 한다.
	- scalability
		- 쿠버네티스 기능을 활용하여 CPU, GPU, TPU등의 자원을 확장하거나 축소하여 사용할 수 있다.

- 쿠베플로우는 ML 라이프사이클의 각 단계를 담당하는 컴포넌트로 구성되어 있다.
	- 서드파티 오픈 소스 툴과 자연스럽게 통합될 수 있다.

## 컬리의 요구사항에 이에 따른 선택
- 기존에 컬리는 EKS 아키텍처를 바탕으로 Jupyterhub, MLFlow, Airflow등의 오픈 소스 도구들 사용하고 있었다.
	- 이런 저런 툴이 추가되면서, 데이터 사이언티스트의 고려사항이 많아졌다.
	- 툴 간의 유기성이 낮아 해당 툴들을 사용하는데 복잡도가 늘어났다.
- 이러한 현상을 개선하기 위해 추상화된 형태의 MLOps 플랫폼을 제공하고자 한다.
	- AWS Sagemaker와 Kubeflow중 채택이 결정되었다.

### SageMaker와 Kubeflow
- 컬리에서는 AWS의 Sagemaker를 사용하고 있었다.
	- AWS에서 제공하는 fully-managed MLOps 플랫폼 서비스이다.
	- 노트북 인스턴스를 통해 실험과 모델링을 진행했다.
	- 이를 쿠베플로우가 대체할 수 있을까?
- 두가지 서비스는 모두 머신러닝 라이프 사이클을 통합하는 MLOps 플랫폼 서비스이다.
- 세이지 메이커 특징은 다음과 같다.
	- AWS 리소스들과 자연스럽게 통합되고, 관련 인프라 설정이 편리하다.
	- 쿠베플로우에서 아직 지원하지 않는 컴포넌트들도 통합된 환경에서 지원한다.
	- AWS 리소스와 연계되고, 벤더 락인 가능성이 높으며, 비용이 낮지 않다.
- 쿠베플로우의 특징은 다음과 같다.
	- 이식성이 높다.
		- 쿠버네티스만 있다면 어떠한 환경에서도 배포가 가능하다.
		- 기존에 쿠버네티스를 아키텍처에서 사용하고 있었다면, 추가적인 인프라 구성을 필요로 하지 않는다.
	- 환경 구성에 참고될만한 레퍼런스가 적다.
		- 채택한 오픈소스가 많아 디버깅에 어려움이 있다.
- sagemaker가 더 다양한 영역을 커버할 수 있는건 맞다.
	- 하지만 비용 문제와 벤더 락인 문제는 무시할 수 없다.
	- 쿠버네티스를 사용하는 환경에서 kubeflow를 운영하고, 커버하지 못하는 부분을 다른 오픈소스 툴로 극복하는게 좋은 선택이라 판단했다.
		- 지금같은 경우 이미 쿠버네티스에 대한 환경이 구축되어 있기 때문에 그랬지 않을까 싶다.
