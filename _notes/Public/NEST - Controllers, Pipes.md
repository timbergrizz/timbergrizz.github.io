---
title: NEST - Controllers, Pipes
feed: show
---

- 컨트롤러는 서비스 콜하고, 응답값 받아서 응답 보내는 역할밖에 없다.
	- 실제 쿼리 날아가는 서비스 위주로 만드는 것이 좋다.
- 가끔 클래스 내부 변수로 리포지토리 선언해서 사용하는 경우 있다.
	- 워크스페이스 서비스를 다른 서비스가 상속받아 쓸 수 있다.
		- 상속받아 쓸때는 dependency injection에 문제가 발생할 수 있다.
			- 그럴땐 constructor에 리포지토리를 명시하는 것이 아닌, 그냥 클래스 내부 변수로 삽입하는 것이 좋다.
	- 권장하는 방법은 아니고, 웬만하면 권장대로 constructor 만들어 쓰자.

- Controller 자체는 그냥 요청 받아서 서비스 태우고 응답 보내는게 끝이라 서비스에 집중해야 한다.
	- 컨트롤러에서 넘길때 기본적으로 Param이나 Query는 문자열로 구성된다.
		- 이런 점에서 숫자 설정하면 에러가 발생할 수 있으니 형 변환을 하는 것이 좋다.
		- ParseIntPipe를 이용해 Param을 숫자로 받아올 수 있다.
		- 이 부분은 [공식 문서](https://docs.nestjs.com/pipes) 참고해서 파이프 종류들 알고 활용하면 좋다.
			- ,등의 값을 이용해 여러개의 값을 array로 받는 경우도 있고, 이러한 경우 array pipe를 이용하여 유용하게 사용할 수 있다.
		- 최대한 Nest 내부 프로세스를 사용하는 것이 좋다.
-  근데 Nest에서는 Request, Response 쓰는게 좋은 설계 아니라고 시즌 990423번째 말했다.
	- 이를 최대한 없애주기 위해서 Custom Decorator 만들었다.
	- 이걸 한번 써보도록 하자.
	- 다음과 같이 작성할 수 있다.
		- ![[Pasted image 20221010194541.png]]
- DTO를 모두 지정해줘서 처리하면 단점과 장점이 있다.
	- 단점은 다 정의하고 앉아있는게 준나게 귀찮다는거다.
	- 장점은 이거 검증도 자동으로 되고 어쨌거나 개발할때 좀 더 편해진다는 것이다.
		- 그러니까 웬만하면 쓰자.
